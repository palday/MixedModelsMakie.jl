<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MixedModelsMakie.jl API · MixedModelsMakie</title><meta name="title" content="MixedModelsMakie.jl API · MixedModelsMakie"/><meta property="og:title" content="MixedModelsMakie.jl API · MixedModelsMakie"/><meta property="twitter:title" content="MixedModelsMakie.jl API · MixedModelsMakie"/><meta name="description" content="Documentation for MixedModelsMakie."/><meta property="og:description" content="Documentation for MixedModelsMakie."/><meta property="twitter:description" content="Documentation for MixedModelsMakie."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MixedModelsMakie</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">MixedModelsMakie.jl Documentation</a></li><li class="is-active"><a class="tocitem" href>MixedModelsMakie.jl API</a><ul class="internal"><li><a class="tocitem" href="#Coefficient-Plots"><span>Coefficient Plots</span></a></li><li><a class="tocitem" href="#Ridge-Plots"><span>Ridge Plots</span></a></li><li><a class="tocitem" href="#Ridge-2D-Plots"><span>Ridge 2D Plots</span></a></li><li><a class="tocitem" href="#Random-effects-and-group-level-predictions"><span>Random effects and group-level predictions</span></a></li><li><a class="tocitem" href="#Diagnostics"><span>Diagnostics</span></a></li><li><a class="tocitem" href="#Profile-Plots"><span>Profile Plots</span></a></li><li><a class="tocitem" href="#General-plots"><span>General plots</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>MixedModelsMakie.jl API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>MixedModelsMakie.jl API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/palday/MixedModelsMakie.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/palday/MixedModelsMakie.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MixedModelsMakie.jl-API"><a class="docs-heading-anchor" href="#MixedModelsMakie.jl-API">MixedModelsMakie.jl API</a><a id="MixedModelsMakie.jl-API-1"></a><a class="docs-heading-anchor-permalink" href="#MixedModelsMakie.jl-API" title="Permalink"></a></h1><h2 id="Coefficient-Plots"><a class="docs-heading-anchor" href="#Coefficient-Plots">Coefficient Plots</a><a id="Coefficient-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Coefficient-Plots" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.coefplot" href="#MixedModelsMakie.coefplot"><code>MixedModelsMakie.coefplot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">coefplot(x::Union{MixedModel,MixedModelBootstrap}; kwargs...)::Figure
coefplot!(fig::Union{GridLayoutBase.GridLayout, GridLayoutBase.GridPosition, GridLayoutBase.GridSubposition, Makie.Figure}, x::Union{MixedModel,MixedModelBootstrap};
          kwargs...)
coefplot!(ax::Axis, Union{MixedModel,MixedModelBootstrap};
          conf_level=0.95, vline_at_zero=true, show_intercept=true, attributes...)</code></pre><p>Create a coefficient plot of the fixed-effects and associated confidence intervals.</p><p>Inestimable coefficients (coefficients removed by pivoting in the rank deficient case) are excluded.</p><p><code>attributes</code> are passed onto <code>scatter!</code> and <code>errorbars!</code>.</p><p>The mutating methods return the original object.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Inestimable coefficients (coefficients removed by pivoting in the rank deficient case) are excluded.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/coefplot.jl#L1-L19">source</a></section></article><pre><code class="language-julia hljs">using CairoMakie
using MixedModels
using MixedModelsMakie
using Random

verbagg = MixedModels.dataset(:verbagg)

gm1 = fit(MixedModel,
          @formula(r2 ~ 1 + anger + gender + btype + situ + (1|subj) + (1|item)),
          verbagg,
          Bernoulli();
          progress=false)

coefplot(gm1)</code></pre><img src="ac43b36e.png" alt="Example block output"/><pre><code class="language-julia hljs">sleepstudy = MixedModels.dataset(:sleepstudy)

fm1 = fit(MixedModel, @formula(reaction ~ 1 + days + (1 + days|subj)), sleepstudy; progress=false)
boot = parametricbootstrap(MersenneTwister(42), 1000, fm1)

coefplot(boot; conf_level=0.999, title=&quot;Custom Title&quot;)</code></pre><img src="5815660c.png" alt="Example block output"/><h2 id="Ridge-Plots"><a class="docs-heading-anchor" href="#Ridge-Plots">Ridge Plots</a><a id="Ridge-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Ridge-Plots" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.ridgeplot" href="#MixedModelsMakie.ridgeplot"><code>MixedModelsMakie.ridgeplot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ridgeplot(x::Union{MixedModel,MixedModelBootstrap}; kwargs...)::Figure
ridgeplot!(fig::Union{GridLayoutBase.GridLayout, GridLayoutBase.GridPosition, GridLayoutBase.GridSubposition, Makie.Figure}, x::Union{MixedModel,MixedModelBootstrap};
          kwargs...)
ridgeplot!(ax::Axis, Union{MixedModel,MixedModelBootstrap};
          conf_level=0.95, vline_at_zero=true, show_intercept=true, attributes...)</code></pre><p>Create a ridge plot for the bootstrap samples of the fixed effects.</p><p>Densities are normalized so that the maximum density is always 1.</p><p>The highest density interval corresponding to <code>conf_level</code> is marked with a bar at the bottom of each density. Setting <code>conf_level=missing</code> removes the markings for the highest density interval.</p><p><code>attributes</code> are passed onto <a href="#MixedModelsMakie.coefplot"><code>coefplot</code></a>, <code>band!</code> and <code>lines!</code>.</p><p>The mutating methods return the original object.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Inestimable coefficients (coefficients removed by pivoting in the rank deficient case) are excluded.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/ridge.jl#L1-L22">source</a></section></article><pre><code class="language-julia hljs">ridgeplot(boot)</code></pre><img src="1dba7a5b.png" alt="Example block output"/><h2 id="Ridge-2D-Plots"><a class="docs-heading-anchor" href="#Ridge-2D-Plots">Ridge 2D Plots</a><a id="Ridge-2D-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Ridge-2D-Plots" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.ridge2d" href="#MixedModelsMakie.ridge2d"><code>MixedModelsMakie.ridge2d</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ridge2d(bs::MixedModelBootstrap; ptype=:β, kwargs...)
ridge2d!(f::Union{GridLayoutBase.GridLayout, GridLayoutBase.GridPosition, GridLayoutBase.GridSubposition, Makie.Figure}, bs::MixedModelBootstrap; ptype=:β)</code></pre><p>Plot pairwise bivariate scatter plots with overlain densities for a bootstrap sample.</p><p><code>ptype</code> specifies the set of parameters to examine, e.g. <code>:β</code>, <code>:σ</code>, <code>:ρ</code>.</p><p>The mutating methods return the original object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/ridge2d.jl#L1-L10">source</a></section></article><pre><code class="language-julia hljs">ridge2d(boot)</code></pre><img src="033b4a61.png" alt="Example block output"/><h2 id="Random-effects-and-group-level-predictions"><a class="docs-heading-anchor" href="#Random-effects-and-group-level-predictions">Random effects and group-level predictions</a><a id="Random-effects-and-group-level-predictions-1"></a><a class="docs-heading-anchor-permalink" href="#Random-effects-and-group-level-predictions" title="Permalink"></a></h2><h3 id="Caterpillar-Plots"><a class="docs-heading-anchor" href="#Caterpillar-Plots">Caterpillar Plots</a><a id="Caterpillar-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Caterpillar-Plots" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.RanefInfo" href="#MixedModelsMakie.RanefInfo"><code>MixedModelsMakie.RanefInfo</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RanefInfo</code></pre><p>Information on random effects conditional modes/means, variances, etc.</p><p>Used for creating caterpillar plots.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This functionality may be moved upstream into MixedModels.jl in the near future.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/caterpillar.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.ranefinfo" href="#MixedModelsMakie.ranefinfo"><code>MixedModelsMakie.ranefinfo</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ranefinfo(m::MixedModel)</code></pre><p>Return a <code>NamedTuple{fnames(m), NTuple(k, RanefInfo)}</code> from model <code>m</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/caterpillar.jl#L18-L22">source</a></section><section><div><pre><code class="language-julia hljs">ranefinfo(m::MixedModel, gf::Symbol)</code></pre><p>Return a <code>RanefInfo</code> corresponding to the grouping variable <code>gf</code> model <code>m</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/caterpillar.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.caterpillar" href="#MixedModelsMakie.caterpillar"><code>MixedModelsMakie.caterpillar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">caterpillar(m::MixedModel, gf::Symbol; kwargs...)</code></pre><p>Returns a <code>Figure</code> of a &quot;caterpillar plot&quot; of the random-effects means and prediction intervals</p><p>A &quot;caterpillar plot&quot; is a horizontal error-bar plot of conditional means and standard deviations of the random effects.</p><p><code>gf</code> specifies which grouping variable is displayed.</p><p><code>kwargs...</code> are passed on to <a href="#MixedModelsMakie.caterpillar!"><code>caterpillar!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/caterpillar.jl#L144-L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.caterpillar!" href="#MixedModelsMakie.caterpillar!"><code>MixedModelsMakie.caterpillar!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">caterpillar!(f::Indexable, r::RanefInfo;
            orderby=1, cols::Union{Nothing,AbstractVector}=nothing,
            dotcolor=(:red, 0.2), barcolor=:black,
            vline_at_zero::Bool=false)
caterpillar!(f::Indexable, m::MixedModel,
             gf::Symbol=first(fnames(m)); orderby=1,
             cols::Union{Nothing,AbstractVector}=nothing,
             dotcolor=(:red, 0.2), barcolor=:black,
             vline_at_zero::Bool=false)</code></pre><p>Add Axes of a caterpillar plot from <code>r</code> to <code>f</code>.</p><p>When passing a <code>MixedModel</code>, <code>gf</code> specifies which grouping variable is displayed. Alternatively, <a href="#MixedModelsMakie.ranefinfo"><code>ranefinfo</code></a> may be used to construct the <a href="#MixedModelsMakie.RanefInfo"><code>RanefInfo</code></a> object directly. Constructing <code>RanefInfo</code> directly can be used to avoid re-computing the conditional variances.</p><p>The order of the levels on the vertical axes is increasing <code>orderby</code> column of <code>r.ranef</code>, usually the <code>(Intercept)</code> random effects. Setting <code>orderby=nothing</code> will disable sorting, i.e. return the levels in the order they are stored in.</p><p>The display can be restricted to a subset of random effects associated with a grouping variable by specifying <code>cols</code>, either by indices or term names.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Even when not sorting the levels, they might have already been sorted during model matrix construction. If you want impose a particular ordering on the levels, then you must sort the relevant fields in the <code>RanefInfo</code> object before calling <code>caterpillar!</code>.</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>orderby</code> is the <span>$n$</span>th column of the columns specified by <code>cols</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/caterpillar.jl#L79-L112">source</a></section></article><pre><code class="language-julia hljs">using CairoMakie
CairoMakie.activate!(type = &quot;svg&quot;)
using MixedModels
using MixedModelsMakie
sleepstudy = MixedModels.dataset(:sleepstudy)
verbagg = MixedModels.dataset(:verbagg)

fm1 = fit(MixedModel, @formula(reaction ~ 1 + days + (1 + days|subj)), sleepstudy; progress=false)
gm0 = fit(MixedModel,
          @formula(r2 ~ 1 + anger + gender + btype + situ + (1|subj) + (1|item)),
          verbagg,
          Bernoulli();
          progress=false)

subjre = ranefinfo(fm1)[:subj]

caterpillar!(Figure(; size=(800,600)), subjre)</code></pre><img src="d18e3c88.svg" alt="Example block output"/><pre><code class="language-julia hljs">caterpillar!(Figure(; size=(800,600)), subjre; orderby=2)</code></pre><img src="e215756f.svg" alt="Example block output"/><pre><code class="language-julia hljs">caterpillar!(Figure(; size=(800,600)), subjre; orderby=nothing)</code></pre><img src="53197cc8.svg" alt="Example block output"/><pre><code class="language-julia hljs">caterpillar(gm0, :item)</code></pre><img src="403d1d4e.svg" alt="Example block output"/><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.qqcaterpillar" href="#MixedModelsMakie.qqcaterpillar"><code>MixedModelsMakie.qqcaterpillar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">qqcaterpillar(m::MixedModel, gf::Symbol=first(fnames(m));
              kwargs...)</code></pre><p>Returns a <code>Figure</code> of a &quot;qq-caterpillar plot&quot; of the random-effects means and prediction intervals.</p><p><code>gf</code> specifies which grouping variable is displayed.</p><p><code>kwargs...</code> are passed on to <a href="#MixedModelsMakie.qqcaterpillar!"><code>qqcaterpillar!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/caterpillar.jl#L214-L223">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.qqcaterpillar!" href="#MixedModelsMakie.qqcaterpillar!"><code>MixedModelsMakie.qqcaterpillar!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">qqcaterpillar!(f::Indexable, r::RanefInfo;
               cols::Union{Nothing,AbstractVector}=nothing,
               dotcolor=(:red, 0.2), barcolor=:black)
qqcaterpillar!(f::Indexable, m::MixedModel,
               gf::Symbol=first(fnames(m));
               cols::Union{Nothing,AbstractVector}=nothing,
               dotcolor=(:red, 0.2), barcolor=:black,
               vline_at_zero::Bool=false)</code></pre><p>Update the figure with a caterpillar plot with the vertical axis on the Normal() quantile scale.</p><p>When passing a <code>MixedModel</code>, <code>gf</code> specifies which grouping variable is displayed. Alternatively, <a href="#MixedModelsMakie.ranefinfo"><code>ranefinfo</code></a> may be used to construct the <a href="#MixedModelsMakie.RanefInfo"><code>RanefInfo</code></a> object directly. Constructing <code>RanefInfo</code> directly can be used to avoid re-computing the conditional variances.</p><p>The display can be restricted to a subset of random effects associated with a grouping variable by specifying <code>cols</code>, either by indices or term names.</p><p>The order of the levels on the vertical axes is increasing <code>orderby</code> column of <code>r.ranef</code>, usually the <code>(Intercept)</code> random effects. Setting <code>orderby=nothing</code> will disable sorting, i.e. return the levels in the order they are stored in.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/caterpillar.jl#L160-L183">source</a></section></article><pre><code class="language-julia hljs">qqcaterpillar(fm1)</code></pre><img src="b4cc0ad7.svg" alt="Example block output"/><pre><code class="language-julia hljs">qqcaterpillar(gm0, :item)</code></pre><img src="53811d48.svg" alt="Example block output"/><pre><code class="language-julia hljs">qqcaterpillar!(Figure(; size=(400,300)), subjre; cols=[1])</code></pre><img src="7795869a.svg" alt="Example block output"/><pre><code class="language-julia hljs">qqcaterpillar!(Figure(; size=(400,300)), subjre; cols=[:days])</code></pre><img src="5fac985c.svg" alt="Example block output"/><h3 id="Shrinkage-Plots"><a class="docs-heading-anchor" href="#Shrinkage-Plots">Shrinkage Plots</a><a id="Shrinkage-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Shrinkage-Plots" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.shrinkageplot" href="#MixedModelsMakie.shrinkageplot"><code>MixedModelsMakie.shrinkageplot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">shrinkageplot(m::MixedModel, gf::Symbol=first(fnames(m)), θref, args...; kwargs...)</code></pre><p>Return a scatter-plot matrix of the conditional means, b, of the random effects for grouping factor <code>gf</code>.</p><p>Two sets of conditional means are plotted: those at the estimated parameter values and those at <code>θref</code>. The default <code>θref</code> results in <code>Λ</code> being a very large multiple of the identity.  The corresponding conditional means can be regarded as unpenalized.</p><p><code>args...</code> and <code>kwargs...</code> are passed on to <a href="#MixedModelsMakie.shrinkageplot!"><code>shrinkageplot!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/shrinkage.jl#L136-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.shrinkageplot!" href="#MixedModelsMakie.shrinkageplot!"><code>MixedModelsMakie.shrinkageplot!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">shrinkageplot!(f::Indexable, m::MixedModel,
               gf::Symbol=first(fnames(m)), θref;
               ellipse=false, ellipse_scale=1, n_ellipse=5,
               cols::Union{Nothing,AbstractVector}=nothing,
               shrunk_dotcolor=(:blue, 0.25), ref_dotcolor=(:red, 0.25),
               ellipse_color=:green, ellipse_linestyle=:dash)</code></pre><p>Return a scatter-plot matrix of the conditional means, b, of the random effects for grouping factor <code>gf</code>.</p><p>Two sets of conditional means are plotted: those at the estimated parameter values and those at <code>θref</code>. The default <code>θref</code> results in <code>Λ</code> being a very large multiple of the identity.  The corresponding conditional means can be regarded as unpenalized.</p><p>The display can be restricted to a subset of random effects associated with a grouping variable by specifying <code>cols</code>, either by indices or term names.</p><p>Correlation ellipses can be added with <code>ellipse=true</code>, with the number of ellipses controlled by <code>n_ellipse</code>. The ellipses are equally spaced between the outer ellipse and the origin (center). The scaling of the ellipses can be adjusted with the multiplicative <code>ellipse_scale</code>. If you are unable to see the ellipses, try increasing <code>ellipse_scale</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For degenerate (singular) models, the correlation ellipse will also be degenerate, i.e., collapse to a point or line.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/shrinkage.jl#L39-L64">source</a></section></article><pre><code class="language-julia hljs">using CairoMakie
using MixedModels
using MixedModelsMakie
sleepstudy = MixedModels.dataset(:sleepstudy)
verbagg = MixedModels.dataset(:verbagg)

fm1 = fit(MixedModel, @formula(reaction ~ 1 + days + (1 + days|subj)), sleepstudy; progress=false)
shrinkageplot(fm1)</code></pre><img src="90b0b4bb.svg" alt="Example block output"/><pre><code class="language-julia hljs">shrinkageplot(fm1; ellipse=true)</code></pre><img src="9734a27e.svg" alt="Example block output"/><pre><code class="language-julia hljs">shrinkageplot!(Figure(; size=(400,400)), fm1)</code></pre><img src="efe79578.svg" alt="Example block output"/><pre><code class="language-julia hljs">gm1 = fit(MixedModel,
          @formula(r2 ~ 1 + anger + gender + btype + situ + (1|subj) + (1+gender|item)),
          verbagg,
          Bernoulli();
          progress=false)
shrinkageplot(gm1, :item)</code></pre><img src="391683c3.svg" alt="Example block output"/><h2 id="Diagnostics"><a class="docs-heading-anchor" href="#Diagnostics">Diagnostics</a><a id="Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics" title="Permalink"></a></h2><p>We have also provided a few useful plot recipes for common plot types applied to mixed models. These are especially useful for diagnostics and model checking.</p><h3 id="QQ-Plots"><a class="docs-heading-anchor" href="#QQ-Plots">QQ Plots</a><a id="QQ-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#QQ-Plots" title="Permalink"></a></h3><p>The methods for <code>qqnorm</code> and <code>qqplot</code> are implemented using <a href="https://makie.juliaplots.org/v0.15.0/recipes.html">Makie recipes</a>. In other words, these are convenience wrappers for calling the relevant plotting methods on <code>residuals(model)</code>.</p><p>Specify the type of line on the QQ plots with the <code>qqline</code> keyword-argument. The default for <code>qqnorm</code> is <code>:fitrobust</code>, which delivers an R-style line connecting the first and third quartiles. The default for <code>qqplot</code> is <code>:identity</code>, which plots the line with slope = 1 and intercept = 0. The final possibility is <code>:fit</code>, which plots the line of best fit (i.e. regressing the quantiles of the residuals onto the quantiles of the reference distribution).</p><p>The reference distribution for <code>qqnorm</code> is the standard normal, which differs from <a href="https://github.com/JuliaPlots/Makie.jl/pull/1277">the behavior in previous versions of Makie</a>.</p><div class="admonition is-compat"><header class="admonition-header">Compat</header><div class="admonition-body"><p>The <a href="https://makie.juliaplots.org/v0.16/examples/plotting_functions/qqplot/index.html">options and associated names for the <code>qqline</code> keyword argument</a> changed in <a href="https://github.com/JuliaPlots/Makie.jl/pull/1563">Makie 0.16.3</a> (and were broken in Makie 0.16.0-0.16.2). The equivalent to <code>qqline=:R</code> is <code>qqline=:fitrobust</code>. <code>qqline=:R</code> will be supported for backwards compatibility only until the next breaking release.</p></div></div><pre><code class="language-julia hljs">using CairoMakie
using MixedModels
using MixedModelsMakie

sleepstudy = MixedModels.dataset(:sleepstudy)

fm1 = fit(MixedModel, @formula(reaction ~ 1 + days + (1 + days|subj)), sleepstudy; progress=false)
qqnorm(fm1; qqline=:fitrobust)</code></pre><img src="5af65fa4.svg" alt="Example block output"/><pre><code class="language-julia hljs"># the residuals should have mean 0
# and standard deviation equal to the residual standard deviation
qqplot(Normal(0, fm1.σ), fm1)</code></pre><img src="87f794cc.svg" alt="Example block output"/><h2 id="Profile-Plots"><a class="docs-heading-anchor" href="#Profile-Plots">Profile Plots</a><a id="Profile-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Profile-Plots" title="Permalink"></a></h2><p><em>Requires MixedModels 4.14 or above.</em></p><pre><code class="language-julia hljs">using CairoMakie
using MixedModels
using MixedModelsMakie

sleepstudy = MixedModels.dataset(:sleepstudy)
fm1 = fit(MixedModel, @formula(reaction ~ 1 + days + (1 + days|subj)), sleepstudy; progress=false)
pr1 = profile(fm1)
zetaplot(pr1)</code></pre><img src="e9c4643f.svg" alt="Example block output"/><pre><code class="language-julia hljs"># show zeta on the absolute value scale with coverage intervals
zetaplot(pr1; absv=true)</code></pre><img src="5a10181a.svg" alt="Example block output"/><pre><code class="language-julia hljs"># show zeta for the variance components
zetaplot(pr1; absv=true, ptyp=&#39;θ&#39;)</code></pre><img src="0adb9b34.svg" alt="Example block output"/><pre><code class="language-julia hljs">profiledensity(pr1)</code></pre><img src="9de659c6.svg" alt="Example block output"/><pre><code class="language-julia hljs">profiledensity(pr1; share_y_scale=false)</code></pre><img src="6512ad85.svg" alt="Example block output"/><pre><code class="language-julia hljs">profiledensity(pr1; ptyp=&#39;σ&#39;)</code></pre><img src="9de659c6-001.svg" alt="Example block output"/><h2 id="General-plots"><a class="docs-heading-anchor" href="#General-plots">General plots</a><a id="General-plots-1"></a><a class="docs-heading-anchor-permalink" href="#General-plots" title="Permalink"></a></h2><p>We also provide a <code>splom</code> or scatter-plot matrix plot for data frames with numeric columns (i.e. a matrix of all pairwise plots). These plots can be used to visualize the joint distribution of, say, the parameter estimates from a simulation.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.splom!" href="#MixedModelsMakie.splom!"><code>MixedModelsMakie.splom!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">splom!(f::Indexable, df::DataFrame)</code></pre><p>Create a scatter-plot matrix in <code>f</code> from the columns of <code>df</code>.</p><p>Non-numeric columns are ignored.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/xyplot.jl#L50-L56">source</a></section></article><pre><code class="language-julia hljs">using CairoMakie
using DataFrames
using LinearAlgebra
using MixedModelsMakie

data = rmul!(randn(100, 3), LowerTriangular([+1 +0 +0;
                                             +1 +1 +0;
                                             -1 -1 +1]))
df = DataFrame(data, [:x, :y, :z])

splom!(Figure(; size=(800, 800)), df)</code></pre><img src="ab6b6e0c.svg" alt="Example block output"/><p>Meanwhile, <code>splomaxes!</code> provides a lower-level backend for <code>splom!</code></p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MixedModelsMakie.splomaxes!" href="#MixedModelsMakie.splomaxes!"><code>MixedModelsMakie.splomaxes!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">splomaxes!(f::Indexable, labels::AbstractVector{&lt;:AbstractString},
           panel!::Function, args...;
           extraticks::Bool=false, kwargs...)</code></pre><p>Populate f with a set of <code>(k*(k-1))/2</code> axes in a lower triangle for all pairs of <code>labels</code>, where <code>k</code> is the length of <code>labels</code>.  The <code>panel!</code> function should have the signature <code>panel!(ax::Axis, i::Integer, j::Integer, args...; kwargs...)</code> and should draw the [i,j] panel in <code>ax</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/palday/MixedModelsMakie.jl/blob/775a1c2edf5fdcff1fabe914770b0d81e467b47a/src/xyplot.jl#L74-L83">source</a></section></article><pre><code class="language-julia hljs">using Statistics

mat = Array(df)
function pfunc(ax, i, j)
    # note that this references mat from the outer scope!
    # [j, i] because:
    # - i is the row in the figure, which corresponds to the y var in each panel
    # - j is the col in the figure, which corresponds to the x var in each panel
    v = view(mat, :, [j, i])
    scatter!(ax, v; color=(:blue, 0.2))
    cc = cor(eachcol(v)...)
    cc = round(cc; digits=2)
    text!(ax, &quot;r=$(cc)&quot;)
    return ax
end
splomaxes!(Figure(; size=(800, 800)),
           names(df), pfunc)</code></pre><img src="fa61aee3.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« MixedModelsMakie.jl Documentation</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Wednesday 29 May 2024 02:31">Wednesday 29 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
